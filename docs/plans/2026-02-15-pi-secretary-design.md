# Pi 秘书能力设计

> 对标 Sintra AI Gigi，全量覆盖其六大能力域，并利用 Nanobots 独有优势（主动推送、真实执行、跨 Agent 协作）实现超越。

**目标：** 将 Pi 重新定位为个人秘书，专注日程管理、任务管理、目标习惯、信息处理、沟通辅助，其他能力拆分到专门 Agent（如 Lily 负责营销）。

**实现方式：** 重写 Pi 的 SOUL.md，不改代码。Pi 已有全部工具（Calendar、Gmail、Todoist、记忆系统、天气、知识库），缺的只是结构化工作流指引。

**工作流引擎：** Heartbeat 机制（约每 30 分钟轮询一次）+ HEARTBEAT.md 检查清单，让 Pi 主动执行定期任务（晨间简报、邮件检查、日历提醒、周复盘），不需要用户主动来问。

**数据持久化：** 目标、习惯、项目进度等结构化数据存在 workspace 文件中（`inbox.md`、`goals.md`、`habits.md`、`projects.md`、`templates/`），Pi 通过记忆系统自动检索。

**跨 Agent 联动：** 通过 `shared/` 目录，Pi 知道 Lily 的营销进展、其他 Agent 的工作成果，在做日程规划和任务排期时自动考虑。

---

## 工作流总览

| #   | 工作流     | 触发方式                          | 对标 Gigi                       |
| --- | ---------- | --------------------------------- | ------------------------------- |
| 0   | 快速收集   | 随时（用户主动）                  | 无                              |
| 1   | 晨间简报   | Heartbeat 自动                    | 无（Gigi 无主动推送）           |
| 2   | 日程管理   | 用户主动 + Heartbeat              | 日程与时间管理                  |
| 3   | 任务管理   | 用户主动 + 晨间简报               | 任务管理                        |
| 4   | 目标与习惯 | 用户主动 + Heartbeat 定期检查     | 目标与习惯养成                  |
| 5   | 信息处理   | 用户主动                          | 信息处理与总结 + 记忆与认知减负 |
| 6   | 沟通辅助   | 用户主动 + Heartbeat 会议提醒     | 沟通辅助                        |
| 7   | 周复盘     | Heartbeat 自动（周五） + 用户主动 | 无（Gigi 无系统复盘）           |

---

## 工作流 0：快速收集（Inbox）

**触发方式：** 随时。用户随时说任何待办，Pi 不追问细节，直接记录。

**用户说的可能是：**

- "记一下，明天要给 Alex 回邮件"
- "买牛奶"
- "研究一下竞品定价"
- "周五之前把 PPT 做完"

**Pi 的行为：**

1. 提取事项，追加到 workspace 的 `inbox.md`
2. 如果用户顺口提了时间（"周五之前"），记下来但不创建日历/Todoist
3. 简短确认："记下了。" 不多说

**inbox.md 格式：**

```markdown
- [ ] 给 Alex 回邮件（2/19 提到）
- [ ] 买牛奶（2/19 提到）
- [ ] 研究竞品定价（2/19 提到）
- [ ] 周五前做完 PPT（2/19 提到，deadline: 2/21）
```

**清空时机：** 晨间简报时统一安排（见工作流 1）。

---

## 工作流 1：晨间简报

**触发方式：** Heartbeat 轮询，在 `activeHours.start` 后第一次触发时执行。

**推送内容（按顺序）：**

1. **今日日程** — 读取 Google Calendar 当天事件，列出时间 + 标题 + 地点
2. **待办提醒** — 读取 Todoist 今天到期和已过期的任务
3. **未读邮件摘要** — 检查 Gmail 未读重要邮件，每封一句话摘要
4. **天气** — 当天天气概况 + 是否需要带伞/注意温度
5. **收集箱** — 读取 inbox.md 待安排事项，提示用户安排
6. **目标进展** — 读取 `goals.md`，如果有今天该推进的里程碑，提一句

**输出格式示例：**

```
早上好！今天是周三 2/19。

📅 日程（3 件）
- 09:00 产品周会（Zoom）
- 14:00 和 Alex 1:1
- 19:00 健身

✅ 待办（2 件到期）
- 提交报价方案（高优先）
- 回复供应商邮件

📧 邮件（2 封重要）
- Alex: 关于合作方案的反馈
- AWS: 账单通知 $127

🌤 天气
新加坡 28°C 多云，下午有雷阵雨，记得带伞

📥 收集箱（4 件待安排）
- 给 Alex 回邮件
- 买牛奶
- 研究竞品定价
- 周五前做完 PPT ⏰ 2/21

🎯 目标
减重：本周目标 75kg，当前 76kg

需要我把收集箱里的事项排进今天日程吗？
```

**收集箱清空：** 用户可以说"前两个放今天，竞品定价放周四，PPT 已经做了划掉"，Pi 批量处理——创建 Todoist 任务或日历事件，然后从 inbox.md 中移除。

---

## 工作流 2：日程管理

**触发方式：** 用户主动要求 + Heartbeat 定期检查

### a) 创建事件

- 用户说"周三下午和 Alex 开会"，Pi 确认时间 + 时长后直接创建 Google Calendar 事件
- 如果时间模糊（"下午"），Pi 检查日历空闲时段，建议具体时间
- 支持设置提醒、地点、参会人

### b) 冲突检测

- 创建前自动检查是否和已有事件冲突
- 有冲突时告知用户并建议替代时段："下午 2 点已经有产品周会了，要不改到 3:30？"

### c) 日程查询

- "今天还有什么事？" → 列出剩余事件
- "这周还有哪天比较空？" → 扫描本周日历，给出空闲天/时段
- "下周三下午有空吗？" → 查具体时段

### d) 调整事件

- "把和 Alex 的会推迟到周四" → 找到事件，修改时间
- "取消明天的健身" → 删除事件

### e) 收集箱 → 日程转化

- 晨间简报后用户说"前两个放今天下午"，Pi 检查下午空闲时段，创建对应时间块，从 inbox.md 移除

### f) 生成周计划

- 用户说"帮我规划一下这周"或每周一晨间简报时自动触发
- Pi 汇总以下信息生成周计划：
  - Google Calendar 本周已有事件
  - Todoist 本周到期任务
  - inbox.md 待安排事项
  - projects.md 活跃项目的下一步
  - goals.md 本周该推进的目标里程碑
- 输出格式：

```
本周计划（2/17 - 2/21）

周一 — 产品周会 09:00 | 处理报价方案（紧急）
周二 — 和 Alex 1:1 14:00 | 准备 App Store 素材
周三 — 产品发布日 | 全天留给发布
周四 — 竞品定价调研 | 回复合作方邮件
周五 — PPT 截止 | 周复盘

空闲时段：周二上午、周四下午

要调整吗？
```

- 用户确认后，Pi 把还没进日历的事项创建为日历时间块

### g) 截止日与跟进提醒

- Heartbeat 巡检时自动检查：
  - Todoist 中**明天到期**的任务 → 提前一天提醒
  - Google Calendar 中**未来 2 小时内**的事件 → 推送提醒
  - projects.md 中临近 deadline 的项目 → 提醒并建议行动
- 跟进事项：用户说"周五跟进 Alex 的回复"，Pi 记入 inbox.md 并标注跟进日期，到期时主动提醒："周五了，Alex 那边的合作方案还没回复，要发一封跟进邮件吗？"

---

## 工作流 3：任务管理

**触发方式：** 用户主动要求 + 晨间简报收集箱清空时

### a) 零散待办 → 优先级清单

- 用户说"帮我整理一下待办"，Pi 读取 inbox.md + Todoist 现有任务
- 按紧急/重要四象限排序，输出清晰清单：

```
紧急且重要
1. 提交报价方案（明天截止）
2. 回复供应商邮件

重要不紧急
3. 研究竞品定价
4. 完成 PPT（周五前）

调整建议：建议今天先处理 1 和 2，下午开始 4。竞品定价放周四。同意吗？
```

- 用户确认后，Pi 在 Todoist 中设置对应优先级和截止日

### b) 拆解复杂任务

- 用户说"帮我拆一下产品发布的准备工作"
- Pi 把大任务拆成子步骤，创建 Todoist 子任务：

```
产品发布准备
- [ ] 确认发布日期和渠道
- [ ] 准备 App Store 截图和描述
- [ ] 写发布公告
- [ ] 通知合作方
- [ ] 准备社交媒体内容（→ 告知 Lily）

需要调整吗？
```

- 涉及其他 Agent 职责的（如社交媒体内容），写入 `shared/cross-context.md` 通知 Lily

### c) 重复任务和 checklist

- 用户说"每周一提醒我做周报"或"每天早上提醒我吃维生素"
- Pi 在 Todoist 创建重复任务（recurring task）
- 对于流程型重复任务（如"发版 checklist"），Pi 存入 workspace 的 `templates/` 目录，每次触发时从模板生成一份新的 checklist

### d) 多项目进度跟踪

- Pi 在 workspace 维护 `projects.md`，记录活跃项目和当前状态：

```markdown
## 活跃项目

### Remembro 产品发布

- 状态：准备中
- 截止：2/19
- 下一步：准备 App Store 素材
- 关联任务：Todoist #12345

### 网站改版

- 状态：调研阶段
- 截止：3月底
- 下一步：收集竞品参考
```

- 用户问"产品发布进展怎么样了？"，Pi 读取 projects.md + Todoist 任务完成情况，给出进度汇报
- 晨间简报中如果有项目临近截止，自动提醒

---

## 工作流 4：目标与习惯养成

**触发方式：** 用户主动设定 + Heartbeat 定期检查 + 周复盘时回顾

### a) 目标设定与拆解

- 用户说"我想三个月内把体重减到 70kg"或"年底前上线英语课程"
- Pi 引导一次简短对话：当前状态 → 目标值 → 截止日
- 拆成里程碑写入 workspace 的 `goals.md`：

```markdown
## 减重到 70kg

- 当前：78kg（2/15 记录）
- 目标：70kg
- 截止：5/15
- 里程碑：
  - [ ] 3月底 → 75kg
  - [ ] 4月底 → 72kg
  - [ ] 5月中 → 70kg
- 策略：每周跑步 3 次、控制碳水
- 检查频率：每周一
```

- 不追问过多细节，用户说不清楚的 Pi 给合理默认值

### b) 习惯追踪

- 用户说"我想养成每天早起跑步的习惯"
- Pi 记入 `habits.md`，用简单打卡格式：

```markdown
## 每日晨跑

- 目标：每周 5 次，06:30
- 本周：✅ 一 ✅ 二 ❌ 三 ✅ 四 \_\_ 五
- 连续天数：3
- 最长连续：7（上周）
```

- Heartbeat 在晚间检查时问一句："今天跑了吗？"（如果用户当天没主动打卡）
- 连续达标时给正向反馈，中断时不说教，温和提醒

### c) 定期问责

- 按 goals.md 中设定的检查频率（如每周一），Heartbeat 触发进度检查
- Pi 读取目标当前状态，对比里程碑，给出简短汇报：

```
减重目标进展：当前 76kg，3月底目标 75kg，还差 1kg，进度正常。
本周跑了 4 次，做得不错。
```

- 如果落后于计划，建议调整策略而不是只催促

### d) 进度更新

- 用户随时说"今天称了 76kg"或"跑了 5 公里"
- Pi 更新 goals.md/habits.md 中的数据，简短确认："记录了，比上周少了 1kg。"

---

## 工作流 5：信息处理

**触发方式：** 用户主动要求，根据意图自动匹配对应模式。

### 结构化思维工具

| 用户说的话                       | Pi 触发的模式      | 说明                                               |
| -------------------------------- | ------------------ | -------------------------------------------------- |
| "帮我研究一下 AEIS 考试政策"     | `/research`        | 多轮深度调研，成果自动存入知识库                   |
| "新加坡今天几度？"               | `/ask`             | 快问快答，不留痕迹                                 |
| "我想做个英语学习 App，帮我想想" | `/brainstorm`      | 互动式头脑风暴，打磨想法                           |
| "我决定做这个 App 了，帮我启动"  | `/kickoff`         | 把想法变成结构化项目，输出到 projects.md + Todoist |
| "这是昨天开会的笔记，帮我整理"   | `/parse-knowledge` | 提取关键信息，整理进知识库                         |

Pi 不需要用户说斜杠命令，根据意图自动判断走哪个模式。但用户也可以显式说"brainstorm 一下"来指定。

### 邮件处理

- 用户说"帮我看看邮箱有什么重要的"
- Pi 读取 Gmail 未读邮件，按重要度排序，每封一句话摘要
- 用户指定某封："帮我回复这封，答应他的方案但价格要再谈"
- Pi 起草回复，用户确认后直接发送

### 决策辅助

- 用户说"在纠结要不要换办公室，帮我分析一下"
- Pi 引导用户说出考虑因素，然后结构化输出：

```
换办公室 — 决策分析

换的好处：离家近、租金便宜、新装修
不换的好处：客户熟悉地址、搬迁成本、合同未到期
关键因素：合同违约金多少？新地址对客户是否方便？

建议先确认违约金数额再决定。需要我帮你起草问房东的邮件吗？
```

- 重大决策记录到 `shared/decisions.md`

### 与其他工作流的衔接

- `/kickoff` 的输出 → 写入 projects.md（工作流 3 任务管理跟踪）
- `/research` 的成果 → 存入 Google Drive 知识库
- `/parse-knowledge` 的输出 → 存入知识库，关键事项进 inbox.md
- 决策辅助的结论 → 记录到 shared/decisions.md（跨 Agent 共享）

---

## 工作流 6：沟通辅助

**触发方式：** 用户主动要求 + Heartbeat 会议提醒

### a) 邮件起草与发送

- 用户说"帮我写封邮件给 Alex，约下周开会讨论合作"
- Pi 起草邮件，展示给用户确认后直接通过 Gmail 发送
- 支持回复链：用户说"回复他，同意但时间改到周四"，Pi 读取原邮件上下文，起草回复

### b) 消息起草

- 用户说"帮我写个消息给供应商，催一下交货"
- Pi 根据场景调整语气（正式/友好/催促），输出文本供用户复制发送
- 如果是 WhatsApp/Telegram 的联系人，建议直接转发

### c) 会议准备

- 日历中有即将到来的会议，Heartbeat 提前 30 分钟提醒时附带：

```
14:00 和 Alex 1:1（还有 30 分钟）

背景：上次聊了合作方案定价，Alex 说要内部确认
你可能想跟进：定价反馈、合同时间线
相关邮件：Alex 2/17 回复了一封关于预算的邮件
```

- Pi 从记忆系统 + Gmail + 知识库中自动拼接会议背景

### d) 会后跟进

- 会议结束后用户说"刚开完会，记一下：Alex 同意了 8 万的方案，下周签合同"
- Pi 的处理：
  - 关键决策 → 记入 shared/decisions.md
  - 跟进事项"下周签合同" → 记入 inbox.md（带日期）
  - 更新 projects.md 对应项目状态
  - 问一句："需要我发一封会议纪要邮件给 Alex 确认吗？"

---

## 工作流 7：周复盘

**触发方式：** 每周五下午通过 Heartbeat 自动触发，用户也可以随时说"帮我复盘一下这周"。

**Pi 汇总本周数据，生成复盘报告：**

```
本周复盘（2/17 - 2/21）

✅ 完成的事项（8 件）
- 提交报价方案
- 产品发布上线
- 和 Alex 敲定合作
- ...（从 Todoist 已完成任务读取）

❌ 未完成（2 件）
- 竞品定价调研 → 建议移到下周二
- 网站改版素材收集 → 还在等设计师

🎯 目标进展
- 减重：本周 76kg → 75.5kg，达标 ✅
- 晨跑：5/5 天 ✅ 连续第 2 周全勤

📊 习惯打卡
- 晨跑 ✅✅✅✅✅
- 阅读 ✅✅✅❌✅

📝 关键决策
- 和 Alex 确认 8 万合作方案
- 产品定价确定为 $9.9/月

📋 下周重点建议
1. 周二完成竞品定价调研
2. 周三签合作合同
3. 跟进设计师网站素材

要调整下周计划吗？
```

**数据来源：**

| 数据              | 来源                |
| ----------------- | ------------------- |
| 已完成/未完成任务 | Todoist             |
| 本周事件          | Google Calendar     |
| 目标进度          | goals.md            |
| 习惯打卡记录      | habits.md           |
| 本周决策          | shared/decisions.md |
| 重要对话上下文    | memory/ 日记        |

**复盘后动作：**

- 未完成任务 → 用户确认后重新排期到下周
- 目标里程碑 → 更新 goals.md 进度
- 下周计划 → 触发工作流 2 的周计划生成

---

## Workspace 文件结构

```
workspace/
  SOUL.md              ← Pi 秘书人格 + 工作流定义
  HEARTBEAT.md         ← 自动巡检清单
  inbox.md             ← 快速收集箱
  goals.md             ← 目标追踪
  habits.md            ← 习惯打卡
  projects.md          ← 活跃项目进度
  templates/           ← 重复任务模板
  memory/              ← 每日会话日记
  MEMORY.md            ← 长期策展记忆
  knowledge/           ← Google Drive 知识库缓存
```

---

## Heartbeat 配置

```jsonc
{
  "agents": {
    "list": [
      {
        "id": "pi",
        "default": true,
        "heartbeat": {
          "every": "30m",
          "activeHours": {
            "start": "07:30",
            "end": "23:00",
            "timezone": "Asia/Singapore",
          },
          "target": "last",
        },
      },
    ],
  },
}
```

**HEARTBEAT.md 检查清单：**

```markdown
# Heartbeat Checklist

## 晨间简报（每天第一次 heartbeat）

如果今天还没发过晨间简报，执行工作流 1。

## 常规巡检（每次 heartbeat）

1. 检查 Google Calendar 未来 2 小时内的事件，如有 → 推送会议准备提醒
2. 检查 Todoist 明天到期的任务，如有 → 提前提醒
3. 检查 Gmail 未读重要邮件，如有紧急的 → 推送摘要
4. 检查 inbox.md 中有跟进日期是今天的事项 → 推送跟进提醒

## 习惯打卡（晚间 20:00 后）

检查 habits.md，如有今天未打卡的习惯 → 温和提醒

## 目标检查（周一）

读取 goals.md，按检查频率触发进度汇报。

## 周复盘（周五 15:00 后）

如果本周还没做过复盘，执行工作流 7。

## 无事可做时

回复 HEARTBEAT_OK
```

---

## 需要安装的 Skill

| Skill              | 用途                     | 来源                      |
| ------------------ | ------------------------ | ------------------------- |
| `/kickoff`         | 把想法变成结构化项目     | 社区已有                  |
| `/research`        | 深度调研，成果存入知识库 | 社区已有（deep-research） |
| `/ask`             | 快问快答，不留笔记       | 社区已有                  |
| `/brainstorm`      | 互动式头脑风暴           | 社区已有                  |
| `/parse-knowledge` | 把零散文本整理进知识库   | 社区已有                  |

---

## 与 Gigi 的能力覆盖对照

| Gigi 能力      | Pi 对应工作流                         | 超越点                                         |
| -------------- | ------------------------------------- | ---------------------------------------------- |
| 日程与时间管理 | 工作流 2 日程管理                     | 直接操作 Calendar，冲突检测，周计划生成        |
| 任务管理       | 工作流 0 快速收集 + 工作流 3 任务管理 | 直接操作 Todoist，四象限排序，项目跟踪         |
| 目标与习惯养成 | 工作流 4 目标与习惯                   | 持久化文件追踪，Heartbeat 定期问责，习惯打卡   |
| 信息处理与总结 | 工作流 5 信息处理                     | 五个结构化思维工具 + 深度调研 + 知识库存储     |
| 沟通辅助       | 工作流 6 沟通辅助                     | 直接发送 Gmail，会议背景自动拼接，会后跟进闭环 |
| 记忆与认知减负 | QMD 三层记忆 + shared/ 跨 Agent       | 语义搜索，跨 Agent 共享，不锁平台              |
| 无             | 工作流 1 晨间简报                     | Heartbeat 主动推送，Gigi 没有                  |
| 无             | 工作流 7 周复盘                       | 自动汇总全周数据，Gigi 没有                    |
